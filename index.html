<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>DJ 3ë¶„ ì²´í—˜</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #05050a;
      --bg-card: #14141f;
      --bg-soft: #0a0a12;
      --accent: #6ee7ff;
      --accent-soft: rgba(110, 231, 255, 0.2);
      --accent-strong: #a882ff;
      --border: #272739;
      --text-main: #f4f4ff;
      --text-sub: #a3a3c3;
      --danger: #fb7185;
      --radius-lg: 24px;
      --radius-md: 16px;
    }

    * { box-sizing: border-box; }
    
    html {
      -webkit-text-size-adjust: 100%;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Pretendard",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111827 0, #020617 55%, #000 100%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      align-items: stretch;
      justify-content: center;
    }

    .page {
      width: 100%;
      max-width: 960px;
      padding: 20px 16px 40px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #6ee7ff, #1f2937);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #0b1120;
      font-weight: 800;
      font-size: 16px;
    }

    .logo-text { display: flex; flex-direction: column; }
    .logo-title { font-size: 16px; font-weight: 600; }
    .logo-sub { font-size: 12px; color: var(--text-sub); }

    header .tagline {
      font-size: 12px;
      color: var(--text-sub);
    }

    .lang-switch {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--text-sub);
    }

    .lang-btn {
      border-radius: 999px;
      padding: 4px 8px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text-sub);
      font-size: 11px;
      cursor: pointer;
    }
    .lang-btn.active {
      border-color: rgba(148,163,184,0.9);
      background: rgba(15,23,42,0.9);
      color: var(--text-main);
    }

    main { display: flex; flex-direction: column; gap: 16px; flex: 1; }

    .hero-card {
      border-radius: var(--radius-lg);
      padding: 18px 18px 14px;
      background: linear-gradient(135deg, #020617, #020617 40%, #111827 100%);
      border: 1px solid rgba(148, 163, 184, 0.3);
      box-shadow: 0 24px 60px rgba(15, 23, 42, 0.8);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .hero-title { font-size: 20px; font-weight: 700; }
    .hero-sub { font-size: 13px; color: var(--text-sub); line-height: 1.6; }

    .hero-cta {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.2s;
      white-space: nowrap;
      min-height: 40px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #22d3ee);
      color: #f9fafb;
      box-shadow: 0 10px 25px rgba(14, 116, 144, 0.6);
    }
    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 35px rgba(14, 116, 144, 0.9);
    }

    .hint-text { font-size: 11px; color: var(--text-sub); }

    /* DJ ì»¨íŠ¸ë¡¤ëŸ¬ ì˜ì—­ */
    .dj-area {
      margin-top: 2px;
      border-radius: var(--radius-lg);
      padding: 16px 12px 32px;
      background: radial-gradient(circle at top left, #111827, #020617 60%);
      border: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 14px;
      position: relative;
      overflow: visible;
    }

    .dj-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-size: 12px;
      color: var(--text-sub);
      flex-wrap: wrap;
    }

    .dj-header span strong { color: var(--accent); }

    .decks-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .deck {
      flex: 1 1 260px;
      border-radius: var(--radius-md);
      background: radial-gradient(circle at top, #020617, #020617 50%, #020617 100%);
      border: 1px solid var(--border);
      padding: 12px 10px 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      position: relative;
      overflow: hidden;
    }

    .deck.highlight {
      box-shadow: 0 0 0 1px var(--accent), 0 0 32px rgba(110, 231, 255, 0.26);
      border-color: var(--accent);
    }

    .deck-label {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 4px;
      font-size: 11px;
      color: var(--text-sub);
    }

    .pill {
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.4);
      flex-shrink: 0;
    }

    .deck-main {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* ì•¨ë²” ì•„íŠ¸: ì •ì‚¬ê°í˜• */
    .disc {
      width: 52px;
      height: 52px;
      border-radius: 10px;
      background-color: #020617;
      background-size: cover;
      background-position: center;
      border: 1px solid #0b1120;
      box-shadow: 0 8px 16px rgba(15,23,42,0.75);
      position: relative;
      flex-shrink: 0;
      overflow: hidden;
    }

    .discA { background-image: url("imageA.jpg"); }
    .discB { background-image: url("imageB.jpg"); }

    .disc::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 10% 0%, rgba(255,255,255,0.16), transparent 55%);
      pointer-events: none;
      mix-blend-mode: screen;
    }

    .deck-controls {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .track-title { font-size: 13px; font-weight: 500; }

    .track-meta {
      font-size: 11px;
      color: var(--text-sub);
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    /* ë™ê·¸ë€ ì¬ìƒ/ì •ì§€ ë²„íŠ¼ */
    .btn-circle {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #020617;
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 13px;
      transition: background 0.15s ease, box-shadow 0.15s ease, transform 0.08s ease, border 0.15s;
    }

    .btn-circle:hover {
      background: #111827;
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(15, 23, 42, 0.8);
    }

    .btn-circle.playing {
      background: #22c55e;
      border-color: #bbf7d0;
      color: #052e16;
      box-shadow: 0 0 0 1px rgba(190, 242, 100, 0.6), 0 10px 20px rgba(34, 197, 94, 0.6);
    }

    .btn-circle.highlight-control {
      box-shadow: 0 0 0 2px var(--accent), 0 0 18px rgba(110, 231, 255, 0.7);
      border-color: var(--accent);
    }

    .slider-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .slider-label {
      font-size: 11px;
      color: var(--text-sub);
      flex-shrink: 0;
      min-width: 34px;
    }

    .slider-value {
      font-size: 11px;
      color: var(--accent);
      min-width: 42px;
      text-align: right;
      flex-shrink: 0;
    }

    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      flex: 1;
      height: 28px;
      margin: 4px 0;
      background: transparent;
    }

    input[type="range"]::-webkit-slider-runnable-track {
      height: 6px;
      border-radius: 999px;
      background: #020617;
      border: 1px solid #1f2933;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 0 4px var(--accent-soft);
      cursor: pointer;
      margin-top: -7px;
    }

    input[type="range"]::-moz-range-track {
      height: 6px;
      border-radius: 999px;
      background: #020617;
      border: 1px solid #1f2933;
    }

    input[type="range"]::-moz-range-thumb {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 0 4px var(--accent-soft);
      cursor: pointer;
      border: none;
    }

    /* Waveforms */
    .wave-row {
      margin-top: 2px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .wave-label {
      font-size: 10px;
      color: var(--text-sub);
    }

    .wave {
      position: relative;
      height: 24px;
      border-radius: 999px;
      background: linear-gradient(
        90deg,
        rgba(15,23,42,0.8),
        rgba(30,64,175,0.7),
        rgba(15,23,42,0.8)
      );
      overflow: hidden;
      border: 1px solid rgba(30,64,175,0.6);
    }

    .wave::before {
      content: "";
      position: absolute;
      inset: 4px 0;
      background-image: linear-gradient(
        to right,
        rgba(248,250,252,0.1) 8px,
        transparent 8px
      );
      background-size: 16px 100%;
      opacity: 0.4;
      pointer-events: none;
    }

    .wave-progress {
      position: absolute;
      inset: 0;
      width: 0%;
      background: linear-gradient(90deg, rgba(96,165,250,0.6), rgba(56,189,248,0.9));
      mix-blend-mode: screen;
      transition: width 0.1s linear;
    }

    .wave-flag {
      position: absolute;
      top: 0;
      width: 2px;
      height: 100%;
      background: var(--danger);
      box-shadow: 0 0 8px rgba(248,113,113,0.8);
    }

    .wave-flag::after {
      content: "";
      position: absolute;
      top: -4px;
      left: -3px;
      border-left: 4px solid transparent;
      border-right: 4px solid transparent;
      border-bottom: 6px solid var(--danger);
    }

    .wave-highlight {
      box-shadow: 0 0 0 1px var(--accent), 0 0 18px rgba(110,231,255,0.3);
    }

    .mixer {
      margin-top: 4px;
      border-radius: var(--radius-md);
      background: linear-gradient(135deg, #020617, #020617 45%, #111827 100%);
      border: 1px solid var(--border);
      padding: 10px 10px 26px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .mixer-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    /* EQ & Volumes */
    .eq {
      flex: 1 1 220px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .xfader-label {
      font-size: 11px;
      color: var(--text-sub);
      display: flex;
      justify-content: space-between;
      gap: 4px;
    }

    .eq-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .eq-row span {
      font-size: 11px;
      width: 40px;
      color: var(--text-sub);
      flex-shrink: 0;
    }

    .eq-row .eq-val {
      font-size: 11px;
      color: var(--text-sub);
      width: 52px;
      text-align: right;
      flex-shrink: 0;
    }

    .eq-highlight input[type="range"] {
      box-shadow: 0 0 0 1px var(--accent), 0 0 18px rgba(110,231,255,0.4);
    }

    .volumes {
      flex: 0 0 150px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 11px;
      color: var(--text-sub);
    }

    .volumes span strong { color: var(--accent); }

    /* ë§í’ì„  í† ìŠ¤íŠ¸ */
    .toast {
      position: fixed;
      left: 50%;
      top: 40%;
      transform: translate(-50%, -50%);
      padding: 6px 12px; /* ì„¸ë¡œ íŒ¨ë”© ì¤„ì—¬ì„œ ë‚©ì‘í•˜ê²Œ */
      background: radial-gradient(circle at top left, rgba(15,23,42,0.98), rgba(15,23,42,0.92));
      border: 1px solid rgba(148,163,184,0.85);
      border-radius: 999px;
      color: var(--text-main);
      font-size: 13px;
      line-height: 1.2;          /* ì„¸ë¡œ ë†’ì´ ê°•ì œ ì¶•ì†Œ */
      max-width: 80%;
      text-align: center;
      box-shadow: 0 14px 30px rgba(15,23,42,0.9);
      opacity: 0;
      pointer-events: none;
      z-index: 9999;
      transition: opacity 0.3s ease;
      display: inline-flex;
      align-items: center;       /* í…ìŠ¤íŠ¸ë¥¼ ìº¡ìŠ ê°€ìš´ë°ë¡œ */
      justify-content: center;
    }

    /* í˜¹ì‹œ í† ìŠ¤íŠ¸ ì•ˆì— ë²„íŠ¼ ì“¸ ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ ì‚¬ì´ì¦ˆ ê³ ì • */
    .toast button {
      font-size: 12px;
      padding: 4px 8px;
    }

    .toast::after {
      content: "";
      position: absolute;
      bottom: -4px; /* ê¼¬ë¦¬ ì‚´ì§ ìœ„ë¡œ */
      left: 50%;
      transform: translateX(-50%);
      border-width: 4px 5px 0 5px;
      border-style: solid;
      border-color: rgba(15,23,42,0.98) transparent transparent transparent;
    }

    .toast.visible {
      opacity: 1;
    }


    /* ì˜¤ë²„ë ˆì´ íŠœí† ë¦¬ì–¼ */
    .overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.55), rgba(3, 7, 18, 0.75));
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 20;
      padding: 16px;
    }

    .overlay.hidden {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .overlay-card {
      width: 100%;
      max-width: 420px;
      border-radius: var(--radius-lg);
      background: radial-gradient(circle at top left, #111827, #020617 65%);
      border: 1px solid rgba(148, 163, 184, 0.7);
      box-shadow: 0 30px 80px rgba(15, 23, 42, 0.85);
      padding: 18px 16px 14px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      position: relative;
      overflow: hidden;
    }

    .overlay-card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background: radial-gradient(circle at 0 0, rgba(110, 231, 255, 0.18), transparent 60%);
      opacity: 0.7;
      pointer-events: none;
    }

    .overlay-eyebrow {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--accent);
      position: relative;
      z-index: 1;
    }

    .overlay-title {
      font-size: 18px;
      font-weight: 600;
      position: relative;
      z-index: 1;
    }

    .overlay-body {
      font-size: 13px;
      color: var(--text-sub);
      line-height: 1.7;
      position: relative;
      z-index: 1;
    }

    .overlay-body ul { margin: 6px 0 0; padding-left: 18px; }
    .overlay-body li { margin-bottom: 4px; }

    .overlay-footer {
      margin-top: 8px;
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      align-items: center;
      position: relative;
      z-index: 1;
    }

    .overlay-step { font-size: 11px; color: var(--text-sub); }

    .overlay-btn-main {
      padding-inline: 16px;
      padding-block: 8px;
      border-radius: 999px;
      border: none;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #4f46e5, #22d3ee);
      color: #f9fafb;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 12px 30px rgba(14, 116, 144, 0.7);
      min-height: 38px;
    }

    .overlay-btn-main:hover {
      box-shadow: 0 16px 40px rgba(14, 116, 144, 1);
      transform: translateY(-1px);
    }

    .overlay-btn-sub {
      border: none;
      background: transparent;
      color: var(--text-sub);
      font-size: 11px;
      cursor: pointer;
    }

    .celebrate {
      font-size: 14px;
      line-height: 1.7;
      color: var(--text-sub);
    }

    .celebrate strong { color: var(--accent-strong); }

    /* ë°˜ì‘í˜• ì¡°ì • */
    @media (max-width: 768px) {
      .page { padding-inline: 12px; }
      header .tagline { font-size: 11px; max-width: 100%; }
      .hero-title { font-size: 18px; }
      .hero-card { padding-inline: 14px; }
      .dj-area { padding-inline: 10px; }
      .disc { width: 46px; height: 46px; }
      .decks-row { flex-direction: column; }
      .mixer-row { flex-direction: column; }
      .volumes { flex: 1 1 auto; }
    }

    @media (max-width: 480px) {
      .hero-title { font-size: 17px; }
      .hero-sub { font-size: 12px; }
      .logo-title { font-size: 14px; }
      .dj-header { font-size: 11px; }
      .overlay-card { padding-inline: 14px; }

      .toast {
        font-size: 11px;      /* ëª¨ë°”ì¼ì—ì„œ ê¸€ì ì‚´ì§ ì¤„ì„ */
        padding: 5px 10px;    /* ì„¸ë¡œ í•œ ë²ˆ ë” ì••ì¶• */
        max-width: 88%;
        top: 35%;             /* í™”ë©´ ì¢€ ë” ìœ„ìª½ìœ¼ë¡œ */
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="logo">
        <div class="logo-icon">DJ</div>
        <div class="logo-text">
          <div class="logo-title" id="logoTitle"></div>
          <div class="logo-sub" id="logoSub"></div>
        </div>
      </div>
      <div style="display:flex; align-items:center; gap:10px; flex-wrap:wrap;">
        <div class="tagline" id="headerTagline"></div>
        <div class="lang-switch">
          <span id="langLabel"></span>
          <button class="lang-btn active" id="langKo">KO</button>
          <button class="lang-btn" id="langEn">EN</button>
        </div>
      </div>
    </header>

    <main>
      <section class="hero-card">
        <div class="hero-title" id="heroTitle"></div>
        <p class="hero-sub" id="heroSub"></p>
        <div class="hero-cta">
          <button id="startTutorialTop" class="btn btn-primary">
            <span id="heroButtonText"></span> <span>â†º</span>
          </button>
          <span class="hint-text" id="heroHint"></span>
        </div>
      </section>

      <section class="dj-area">
        <div class="dj-header">
          <span id="djHeaderLeft"></span>
          <span id="djHeaderRight"></span>
        </div>

        <div class="decks-row">
          <!-- Deck A -->
          <div class="deck" id="deckA">
            <div class="deck-label">
              <span id="deckALabel"></span>
              <span class="pill" id="deckAPill"></span>
            </div>
            <div class="deck-main">
              <div class="disc discA"></div>
              <div class="deck-controls">
                <div class="track-title" id="trackATitle"></div>
                <div class="track-meta">
                  <span id="metaA"></span>
                </div>
                <div style="display:flex; gap:8px; align-items:center;">
                  <button id="playA" class="btn-circle" aria-label="Deck A ì¬ìƒ/ì •ì§€">
                    â–¶
                  </button>
                  <span style="font-size:11px; color:var(--text-sub);" id="playALabel"></span>
                </div>
              </div>
            </div>
            <div class="slider-row">
              <span class="slider-label" id="volALabel"></span>
              <input type="range" id="volA" min="0" max="100" value="100" />
              <span class="slider-value" id="volAVal">100%</span>
            </div>
            <div class="wave-row">
              <div class="wave-label" id="waveALabel"></div>
              <div class="wave" id="waveA">
                <div class="wave-progress" id="waveAProg"></div>
                <div class="wave-flag" id="waveAFlag"></div>
              </div>
            </div>
          </div>

          <!-- Deck B -->
          <div class="deck" id="deckB">
            <div class="deck-label">
              <span id="deckBLabel"></span>
              <span class="pill" id="deckBPill"></span>
            </div>
            <div class="deck-main">
              <div class="disc discB"></div>
              <div class="deck-controls">
                <div class="track-title" id="trackBTitle"></div>
                <div class="track-meta">
                  <span id="metaB"></span>
                </div>
                <div style="display:flex; gap:8px; align-items:center;">
                  <button id="playB" class="btn-circle" aria-label="Deck B ì¬ìƒ/ì •ì§€">
                    â–¶
                  </button>
                  <span style="font-size:11px; color:var(--text-sub);" id="playBLabel"></span>
                </div>
              </div>
            </div>
            <div class="slider-row">
              <span class="slider-label" id="bpmLabel"></span>
              <input type="range" id="bpmB" min="120" max="140" value="127" />
              <span class="slider-value" id="bpmBVal">127</span>
            </div>
            <div class="slider-row">
              <span class="slider-label" id="volBLabel"></span>
              <input type="range" id="volB" min="0" max="100" value="0" />
              <span class="slider-value" id="volBVal">0%</span>
            </div>
            <div class="wave-row">
              <div class="wave-label" id="waveBLabel"></div>
              <div class="wave" id="waveB">
                <div class="wave-progress" id="waveBProg"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Mixer (EQ + Volumes) -->
        <div class="mixer">
          <div class="mixer-row">
            <!-- EQ -->
            <div class="eq">
              <div class="xfader-label">
                <span id="eqTitle"></span>
                <span id="eqSubTitle"></span>
              </div>
              <div class="eq-row" id="eqRowHigh">
                <span id="eqHighLabel"></span>
                <input type="range" id="eqHigh" min="-40" max="10" value="-20" />
                <span class="eq-val" id="eqHighVal">-20 dB</span>
              </div>
              <div class="eq-row" id="eqRowMid">
                <span id="eqMidLabel"></span>
                <input type="range" id="eqMid" min="-40" max="10" value="-20" />
                <span class="eq-val" id="eqMidVal">-20 dB</span>
              </div>
              <div class="eq-row" id="eqRowLow">
                <span id="eqLowLabel"></span>
                <input type="range" id="eqLow" min="-40" max="10" value="-20" />
                <span class="eq-val" id="eqLowVal">-20 dB</span>
              </div>
            </div>

            <!-- Volumes Summary -->
            <div class="volumes">
              <span id="volSummaryTitle"></span>
              <span id="volSummaryA"></span>
              <span id="volSummaryB"></span>
            </div>
          </div>
        </div>

        <!-- ë§í’ì„  í† ìŠ¤íŠ¸ -->
        <div class="toast" id="toast"></div>
      </section>
    </main>
  </div>

  <!-- íŠœí† ë¦¬ì–¼ ì˜¤ë²„ë ˆì´ -->
  <div class="overlay" id="overlay">
    <div class="overlay-card">
      <div class="overlay-eyebrow" id="overlayEyebrow"></div>
      <div class="overlay-title" id="overlayTitle"></div>
      <div class="overlay-body" id="overlayBody"></div>
      <div class="overlay-footer">
        <span class="overlay-step" id="overlayStepText"></span>
        <button class="overlay-btn-sub" id="overlaySkip"></button>
        <button class="overlay-btn-main" id="overlayNext"></button>
      </div>
    </div>
  </div>

  <!-- ì˜¤ë””ì˜¤ ìš”ì†Œ (ìˆ¨ê¹€) -->
  <audio id="audioA" src="trackA.mp3" loop preload="none"></audio>
  <audio id="audioB" src="trackB.mp3" loop preload="none"></audio>

  <script>
    // --------- ë¬¸ìì—´ (KO / EN) ---------
    const STRINGS = {
      ko: {
        logoTitle: "ë””ì œì‰ 3ë¶„ ì²´í—˜",
        logoSub: "ì²˜ìŒ ë§Œì ¸ë³´ëŠ” ì‚¬ëŒì„ ìœ„í•œ ì´ˆê°„ë‹¨ íŠœí† ë¦¬ì–¼",
        headerTagline: "â€œí•œ ê³¡ì²˜ëŸ¼ ë“¤ë¦¬ê²Œ ë§Œë“¤ê¸°â€ê°€ ì˜¤ëŠ˜ì˜ ëª©í‘œì…ë‹ˆë‹¤.",
        langLabel: "ì–¸ì–´",
        heroTitle: "ë””ì œì´ê°€ ë­˜ í•˜ëŠ”ì§€, ì§ì ‘ ì†ìœ¼ë¡œ ëŠê»´ë³´ê¸°",
        heroSub: "ì¥ë¹„ëŠ” ì—†ì–´ë„ ê´œì°®ì•„ìš”. ë¸Œë¼ìš°ì € ì•ˆì—ì„œ ë‘ ê³¡ì„ ì„ì–´ ë³´ë©´ì„œ\në°•ì, í†¤, ë³¼ë¥¨ì„ ëˆˆê³¼ ê·€ë¡œ í•œ ë²ˆì— ì´í•´í•  ìˆ˜ ìˆì–´ìš”.",
        heroButtonText: "íŠœí† ë¦¬ì–¼ ë‹¤ì‹œ ì‹œì‘í•˜ê¸°",
        heroHint: "í—¤ë“œí°ì„ ë¼ê³  í•˜ë©´ ë” ì¬ë°ŒìŠµë‹ˆë‹¤ ğŸ§",
        djHeaderLeft: "ğŸšï¸ <strong>Step-by-step</strong> ë¯¹ìŠ¤ ì—°ìŠµ ê³µê°„",
        djHeaderRight: "ì™¼ìª½ ê³¡ì—ì„œ ì˜¤ë¥¸ìª½ ê³¡ìœ¼ë¡œ ë¶€ë“œëŸ½ê²Œ ë„˜ì–´ê°€ ë´…ì‹œë‹¤.",

        deckALabel: "Deck A",
        deckAPill: "í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ê³¡",
        deckBLabel: "Deck B",
        deckBPill: "ê³§ ë“¤ì–´ì˜¬ ë‹¤ìŒ ê³¡",
        trackATitle: "Robin Graham â€“ Pipe Dream",
        trackBTitle: "Salomo â€“ Motion",
        metaA: "8A Â· 131 BPM",
        metaB: "8B Â· 127 BPM â†’ 131 BPM",
        playLabel: "ì¬ìƒ / ì •ì§€",
        volLabel: "ë³¼ë¥¨",
        bpmLabel: "BPM",
        waveALabel: "íƒ€ì„ë¼ì¸ (Deck A)",
        waveBLabel: "íƒ€ì„ë¼ì¸ (Deck B)",

        eqTitle: "EQ (Deck B)",
        eqSubTitle: "ê³  Â· ì¤‘ Â· ì €ìŒ ìˆœì„œë¡œ ëê¹Œì§€ ì˜¬ë ¤ë³´ë©° ë³€í™”ë¥¼ ëŠê»´ë³´ì„¸ìš”.",
        eqHighLabel: "HIGH",
        eqMidLabel: "MID",
        eqLowLabel: "BASS",

        volSummaryTitle: "í˜„ì¬ ìƒíƒœ",
        volSummaryA: "Deck A ë³¼ë¥¨: <strong id=\"statusVolA\">100%</strong>",
        volSummaryB: "Deck B ë³¼ë¥¨: <strong id=\"statusVolB\">0%</strong>",

        overlaySkip: "íŠœí† ë¦¬ì–¼ ê±´ë„ˆë›°ê¸°",
        overlayNext: "ê³„ì†í•˜ê¸°",

        tutorial: {
          1: {
            eyebrow: "íŠœí† ë¦¬ì–¼ Â· Step 1",
            title: "ì–´ì„œ ì˜¤ì„¸ìš”!",
            body: `ë””ì œì‰ì´ ë­”ì§€ ê¶ê¸ˆí•´ í•˜ì…¨ì£ ?<br/>
ì§€ê¸ˆë¶€í„° ë¸Œë¼ìš°ì € ì•ˆì—ì„œ ì§ì ‘ <strong>ë‘ ê³¡ì„ í•œ ê³¡ì²˜ëŸ¼</strong> ì„ì–´ ë³´ë©´ì„œ ì•Œë ¤ë“œë¦´ê²Œìš”.`,
            stepsText: "1 / 9",
          },
          2: {
            eyebrow: "íŠœí† ë¦¬ì–¼ Â· Step 2",
            title: "ë””ì œì‰ì€ ë¬´ì—‡ì„ í• ê¹Œìš”?",
            body: `ë””ì œì‰ì€ ì„œë¡œ ë‹¤ë¥¸ ë‘ ê³¡ì„ <strong>í•˜ë‚˜ì˜ íë¦„ì²˜ëŸ¼</strong> ì´ì–´ë¶™ì´ëŠ” ê³¼ì •ì´ì—ìš”.<br/><br/>
ê·¸ëŸ´ë ¤ë©´ ì„¸ ê°€ì§€ë§Œ ë§ìœ¼ë©´ ë©ë‹ˆë‹¤:
<ul>
  <li>ğŸšï¸ <strong>ë°•ì(BPM)</strong> â€“ ì†ë„ë¥¼ ë¹„ìŠ·í•˜ê²Œ ë§ì¶”ê³ </li>
  <li>ğŸµ <strong>ì¡°ì„±(Key)</strong> â€“ ì–´ìš¸ë¦¬ëŠ” ê³¡ë¼ë¦¬ ê³ ë¥´ê³ </li>
  <li>âš–ï¸ <strong>ë³¼ë¥¨ ë°¸ëŸ°ìŠ¤</strong> â€“ í•œ ê³¡ì´ ê°•í•  ë• ë‹¤ë¥¸ ê³¡ì€ ì‚´ì§ ë¹ ì§€ë„ë¡</li>
</ul>`,
            stepsText: "2 / 9",
          },
          3: {
            eyebrow: "íŠœí† ë¦¬ì–¼ Â· Step 3",
            title: "ì˜¤ëŠ˜ ë§Œì§ˆ ì¥ë¹„ë¥¼ ì†Œê°œí•©ë‹ˆë‹¤.",
            body: `í™”ë©´ ì•„ë˜ ì¥ë¹„ê°€ ë³´ì´ì‹œì£ ?<br/>
ì™¼ìª½ì´ <strong>í˜„ì¬ ê³¡(Deck A)</strong>, ì˜¤ë¥¸ìª½ì´ <strong>ë‹¤ìŒ ê³¡(Deck B)</strong>ì´ì—ìš”.<br/><br/>
ì§€ê¸ˆì€ Deck Aê°€ ì¬ìƒë˜ê³  ìˆìŠµë‹ˆë‹¤.`,
            stepsText: "3 / 9",
          },
          4: {
            eyebrow: "íŠœí† ë¦¬ì–¼ Â· Step 4",
            title: "ì†ë„ëŠ” ì´ë¯¸ ë§ì¶° ë†¨ì–´ìš”",
            body: `ì˜¤ë¥¸ìª½ Deck Bì— <strong>BPM ìŠ¬ë¼ì´ë”</strong>ê°€ ë³´ì´ì‹œì£ ?<br/>
          ì‹¤ì œ ë””ì œì‰ì—ì„œëŠ” ì´ê±¸ë¡œ ê³¡ì˜ ì†ë„ë¥¼ ë§ì¶¥ë‹ˆë‹¤.<br/><br/>
          ì´ë²ˆ ë°ëª¨ì—ì„œëŠ” ë‘ ê³¡ì„ ë¯¸ë¦¬ <strong>ê°™ì€ ì†ë„(131 BPM)</strong>ë¡œ ë Œë”ë§í•´ ë’€ì–´ìš”.<br/>
          ê·¸ë˜ë„ ëŠë‚Œì„ ìµí˜€ë³´ê¸° ìœ„í•´, ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ <strong>131</strong>ì— ë”± ë§ì¶°ë³´ì„¸ìš”.`,
            stepsText: "4 / 9",
          },
          5: {
            eyebrow: "íŠœí† ë¦¬ì–¼ Â· Step 5",
            title: "ì¢‹ì€ íƒ€ì´ë°ì— ë‘ ë²ˆì§¸ ê³¡ ë„£ê¸°",
            body: `ì´ì œ Deck AëŠ” ê³¡ì˜ í•œ ì§€ì ì„ í–¥í•´ ê°€ê³  ìˆê³ ,<br/>
Deck BëŠ” ë“¤ì–´ì˜¬ ì¤€ë¹„ë¥¼ í•˜ê³  ìˆì–´ìš”.<br/><br/>
ìŒì•…ì„ ì¦ê¸°ì‹œë‹¤ê°€ Deck A íƒ€ì„ë¼ì¸ì˜ <strong>ë¹¨ê°„ í‘œì‹œ</strong>ê°€ ë‹¤ê°€ì˜¤ë©´,<br/>
ê·¸ë•Œ Deck Bì˜ â–¶ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.<br/>
(ì´ ìŠ¤í…ì—ì„œëŠ” ê¹”ë”í•˜ê²Œ ë“¤ì–´ê°€ë„ë¡ ìë™ìœ¼ë¡œ ë§ì¶° ë“œë¦¬ë‹ˆ, ë„ˆë¬´ ê¸´ì¥í•˜ì§€ ë§ˆì„¸ìš”!)`,
            stepsText: "5 / 9",
          },
          6: {
            eyebrow: "íŠœí† ë¦¬ì–¼ Â· Step 6",
            title: "ë‘ ë²ˆì§¸ ê³¡ì˜ ì¡´ì¬ê° í‚¤ìš°ê¸°",
            body: `ë‘ ê³¡ì´ í•¨ê»˜ ì¬ìƒë˜ê¸° ì‹œì‘í–ˆë‹¤ë©´,<br/>
ì´ì œ Deck Bì˜ <strong>ë³¼ë¥¨ì„ ëê¹Œì§€ ì˜¬ë ¤ì„œ</strong><br/>
ë‘ ë²ˆì§¸ ê³¡ì´ ë¶„ëª…íˆ ë“¤ë¦¬ê²Œ ë§Œë“¤ì–´ ë³¼ ê±°ì˜ˆìš”.`,
            stepsText: "6 / 9",
          },
          7: {
            eyebrow: "íŠœí† ë¦¬ì–¼ Â· Step 7",
            title: "ê³  Â· ì¤‘ Â· ì €ìŒëŒ€ë¡œ ìë¦¬ ë°”ê¾¸ê¸°",
            body: `ì´ì œ Deck Bì˜ EQë¥¼ ë§Œì§€ë©´ì„œ <strong>ëˆ„ê°€ ë” ì•ì— ì„¤ì§€</strong> ì •í•´ë³¼ ì°¨ë¡€ì—ìš”.<br/><br/>
<strong>HIGH â†’ MID â†’ BASS</strong> ìˆœì„œë¡œ,<br/>
ê° ìŠ¬ë¼ì´ë”ë¥¼ <strong>ìœ„ìª½ ëê¹Œì§€</strong> ì˜¬ë ¤ë³´ì„¸ìš”.`,
            stepsText: "7 / 9",
          },
          8: {
            eyebrow: "íŠœí† ë¦¬ì–¼ Â· Step 8",
            title: "ì²« ë²ˆì§¸ ê³¡ì„ ë¶€ë“œëŸ½ê²Œ í‡´ì¥ì‹œí‚¤ê¸°",
            body: `Deck Bì˜ ì¡´ì¬ê°ì´ ì¶©ë¶„íˆ ì˜¬ë¼ì™”ë‹¤ë©´,<br/>
ì´ì œ ì²« ë²ˆì§¸ ê³¡(Deck A)ì„ <strong>ì²œì²œíˆ ë’¤ë¡œ ë³´ë‚´ì¤„</strong> ì°¨ë¡€ì˜ˆìš”.<br/><br/>
Deck Aì˜ ë³¼ë¥¨ì„ ìŠ¬ìŠ¬ ë‚´ë ¤ì„œ <strong>ë§¨ ì•„ë˜</strong>ê¹Œì§€ ë§Œë“¤ê³ ,<br/>
ê·¸ë‹¤ìŒ, ë§ˆì§€ë§‰ìœ¼ë¡œ Deck Aì˜ â¸ ë²„íŠ¼ì„ ëˆŒëŸ¬ êº¼ì£¼ë©´ ë¯¹ìŠ¤ ì™„ì„±ì…ë‹ˆë‹¤.`,
            stepsText: "8 / 9",
          },
          9: {
            eyebrow: "ë!",
            title: "ì§ì§ì§!! ë””ì œì´ê°€ ë˜ì‹  ê±¸ ì¶•í•˜í•©ë‹ˆë‹¤ ğŸ‰",
            body: `<div class="celebrate">
ë°©ê¸ˆ í•˜ì‹  ì¼ì€ ì‹¤ì œ í´ëŸ½ì—ì„œ ë””ì œì´ê°€ í•˜ëŠ” ì¼ê³¼ <strong>ê±°ì˜ ë™ì¼í•œ íë¦„</strong>ì´ì—ìš”.<br/><br/>
ì–¸ì  ê°€ ì§„ì§œ ì¥ë¹„ë¥¼ ë§Œë‚¬ì„ ë•Œ, í›¨ì”¬ ëœ ë‚¯ì„¤ê²Œ ëŠê»´ì§ˆ ê±°ì˜ˆìš” :)
</div>`,
            stepsText: "ì™„ë£Œ",
          },
        },
        toasts: {
          bpmAsk: "Deck Bì˜ BPMì„ 131ë¡œ ë§ì¶°ë³´ì„¸ìš”.",
          bpmPerfect: "ì™„ë²½í•©ë‹ˆë‹¤. 131 BPMìœ¼ë¡œ ë§ì¶°ì¡Œì–´ìš”.",
          syncHint: "Deck Aì˜ ë¹¨ê°„ ì§€ì ì„ ë³´ë‹¤ê°€, ì¢‹ë‹¤ ì‹¶ì„ ë•Œ Deck B â–¶ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”.",
          syncDone: "ë”± ì¢‹ì•˜ì–´ìš”! ë‘ ê³¡ì´ ê°™ì´ ë‹¬ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.",
          volBAsk: "Deck B ë³¼ë¥¨ì„ ëê¹Œì§€ ì˜¬ë ¤ë³´ì„¸ìš”.",
          volBDone: "ì´ì œ ë‘ ë²ˆì§¸ ê³¡ì´ ì¶©ë¶„íˆ ì•ì— ì„œ ìˆìŠµë‹ˆë‹¤.",
          eqHigh: "í•˜ì´í–‡/ê³µê¸°ê°ì´ ë” ì‚´ì•„ë‚¬ì–´ìš”. ì´ì œ MIDë¥¼ ì˜¬ë ¤ë³¼ê¹Œìš”?",
          eqMid: "ë³´ì»¬/ì•…ê¸° ì†Œë¦¬ê°€ ë˜ë ·í•´ì¡Œì£ ? ì´ì œ BASSë¥¼ ì˜¬ë ¤ë´…ì‹œë‹¤.",
          eqLow: "í‚¥ì´ ë¶™ìœ¼ë‹ˆê¹Œ ì§„ì§œ ë°”ë€ ëŠë‚Œ ë‚˜ì£ .",
          volAFade: "Deck A ë³¼ë¥¨ì„ ë§¨ ì•„ë˜ê¹Œì§€ ë‚´ë ¤ë³´ì„¸ìš”.",
          volAStop: "ì¢‹ì•„ìš”! ì´ì œ Deck Aì˜ â¸ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì™„ì „íˆ êº¼ë³¼ê¹Œìš”?",
          skipOverlay: "íŠœí† ë¦¬ì–¼ì€ ì–¸ì œë“  ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ìˆì–´ìš”.",
          skipTop: "íŠœí† ë¦¬ì–¼ì„ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤.",
        },
      },

      en: {
        logoTitle: "3-Minute DJ Demo",
        logoSub: "A tiny tutorial for total beginners",
        headerTagline: "Today's goal: make it sound like one continuous track.",
        langLabel: "Language",
        heroTitle: "Feel what a DJ actually does, with your own hands",
        heroSub: "No hardware? No problem. Mix two tracks in your browser\nand understand tempo, tone, and volume with eyes and ears together.",
        heroButtonText: "Restart tutorial",
        heroHint: "Headphones recommended for maximum nerd joy ğŸ§",
        djHeaderLeft: "ğŸšï¸ <strong>Step-by-step</strong> mix playground",
        djHeaderRight: "Letâ€™s move smoothly from the left track to the right.",

        deckALabel: "Deck A",
        deckAPill: "Currently playing",
        deckBLabel: "Deck B",
        deckBPill: "Next track coming in",
        trackATitle: "Robin Graham â€“ Pipe Dream",
        trackBTitle: "Salomo â€“ Motion",
        metaA: "8A Â· 131 BPM",
        metaB: "8B Â· 127 BPM â†’ 131 BPM",
        playLabel: "Play / Pause",
        volLabel: "Volume",
        bpmLabel: "BPM",
        waveALabel: "Timeline (Deck A)",
        waveBLabel: "Timeline (Deck B)",

        eqTitle: "EQ (Deck B)",
        eqSubTitle: "Raise highs, mids, and lows in order and hear the change.",
        eqHighLabel: "HIGH",
        eqMidLabel: "MID",
        eqLowLabel: "BASS",

        volSummaryTitle: "Current status",
        volSummaryA: "Deck A volume: <strong id=\"statusVolA\">100%</strong>",
        volSummaryB: "Deck B volume: <strong id=\"statusVolB\">0%</strong>",

        overlaySkip: "Skip tutorial",
        overlayNext: "Next",

        tutorial: {
          1: {
            eyebrow: "Tutorial Â· Step 1",
            title: "Welcome!",
            body: `Ever wondered what DJs actually do?<br/>
In this demo youâ€™ll <strong>mix two tracks into one</strong> right in your browser.`,
            stepsText: "1 / 9",
          },
          2: {
            eyebrow: "Tutorial Â· Step 2",
            title: "What is DJing?",
            body: `DJing is about making different songs feel like <strong>one smooth journey</strong>.<br/><br/>
You mainly care about three things:
<ul>
  <li>ğŸšï¸ <strong>Tempo (BPM)</strong> â€“ match the speed</li>
  <li>ğŸµ <strong>Key</strong> â€“ choose tracks that harmonize</li>
  <li>âš–ï¸ <strong>Volume balance</strong> â€“ one track steps back as the other steps forward</li>
</ul>`,
            stepsText: "2 / 9",
          },
          3: {
            eyebrow: "Tutorial Â· Step 3",
            title: "Meet todayâ€™s controller",
            body: `See the UI below?<br/>
The left side is the <strong>current track (Deck A)</strong>, the right is the <strong>next track (Deck B)</strong>.<br/><br/>
For this demo, Deck A is playing around the <strong>middle of the track</strong>.`,
            stepsText: "3 / 9",
          },
          4: {
            eyebrow: "Tutorial Â· Step 4",
            title: "Tempo is already matched for you",
            body: `See the <strong>BPM slider</strong> on Deck B?<br/>
          On real gear, this is where you would match the tempo.<br/><br/>
          In this demo, both tracks are already rendered at<br/>
          <strong>the same tempo (131 BPM)</strong>.<br/>
          Still, try moving the slider and landing exactly on <strong>131</strong> to get a feel for it.`,
            stepsText: "4 / 9",
          },
          5: {
            eyebrow: "Tutorial Â· Step 5",
            title: "Bring in the second track at a good moment",
            body: `Deck A is approaching a mix point,<br/>
and Deck B is ready to come in.<br/><br/>
When Deck Aâ€™s <strong>red marker</strong> reaches the play point,<br/>
hit Deck Bâ€™s â–¶ button.<br/>
In this step, weâ€™ll snap it into a <strong>clean mix point</strong> for you.`,
            stepsText: "5 / 9",
          },
          6: {
            eyebrow: "Tutorial Â· Step 6",
            title: "Turn up the presence of the second track",
            body: `Once both tracks are playing,<br/>
slowly raise <strong>Deck Bâ€™s volume all the way up</strong><br/>
so you can clearly hear the new track coming in.`,
            stepsText: "6 / 9",
          },
          7: {
            eyebrow: "Tutorial Â· Step 7",
            title: "Swap places using highs, mids, and bass",
            body: `Now use EQ on Deck B to decide <strong>who stands in front</strong>.<br/><br/>
Raise them in order: <strong>HIGH â†’ MID â†’ BASS</strong>.<br/>
Each slider should go to the <strong>top of its range</strong>.`,
            stepsText: "7 / 9",
          },
          8: {
            eyebrow: "Tutorial Â· Step 8",
            title: "Let the first track exit gracefully",
            body: `Once Deck B is strong enough,<br/>
itâ€™s time to gently <strong>fade out Deck A</strong>.<br/><br/>
Lower Deck Aâ€™s volume all the way down,<br/>
then press Deck Aâ€™s â¸ button one last time to stop it completely.`,
            stepsText: "8 / 9",
          },
          9: {
            eyebrow: "Done!",
            title: "Nice! You just did a real DJ move ğŸ‰",
            body: `<div class="celebrate">
What you just did is <strong>very close to what club DJs do</strong> on real gear.<br/><br/>
From here, you can play around freely with<br/>
EQ and volume and find <strong>your own timing</strong>.<br/><br/>
Next time you see a DJ, youâ€™ll know exactly what to listen for. :)
</div>`,
            stepsText: "Done",
          },
        },
        toasts: {
          bpmAsk: "Set Deck Bâ€™s BPM to 131.",
          bpmPerfect: "Perfect. Locked at 131 BPM.",
          syncHint: "Watch Deck Aâ€™s red marker and hit â–¶ on Deck B when it feels right.",
          syncDone: "Nice timing! Both tracks are now running together.",
          volBAsk: "Raise Deck Bâ€™s volume all the way up.",
          volBDone: "Now the second track should be clearly up front.",
          eqHigh: "You should hear more air and sparkle. Now raise MID.",
          eqMid: "Vocals/instruments should pop out. Time for BASS.",
          eqLow: "When the kick comes in, the feel really changes.",
          volAFade: "Fade Deck Aâ€™s volume all the way down.",
          volAStop: "Great. Now hit Deck Aâ€™s â–¶ button to fully stop it.",
          skipOverlay: "You can restart the tutorial anytime.",
          skipTop: "Restarting the tutorial from the beginning.",
        },
      }
    };

    // --------- ìƒìˆ˜: ì‹œë‚˜ë¦¬ì˜¤ìš© íƒ€ì„ (ì´ˆ) ----------
    const A_START = 150;       // Pipe Dream ì‹œì‘ ì§€ì 
    const B_START = 29.313;       // Motion ì‹œì‘ ì§€ì 
    const A_FLAG  = 249.16; // ë¯¹ìŠ¤ í¬ì¸íŠ¸ 

    // --------- Audio & Web Audio ----------
    const audioA = document.getElementById("audioA");
    const audioB = document.getElementById("audioB");

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const sourceA = audioCtx.createMediaElementSource(audioA);
    const sourceB = audioCtx.createMediaElementSource(audioB);

    // ê²Œì¸
    const gainA = audioCtx.createGain();
    const gainB = audioCtx.createGain();
    gainA.gain.value = 1;
    gainB.gain.value = 0;

    // AíŠ¸ë™ EQ
    const lowA = audioCtx.createBiquadFilter();
    lowA.type = "lowshelf";
    lowA.frequency.value = 200;
    lowA.gain.value = 0;

    const midA = audioCtx.createBiquadFilter();
    midA.type = "peaking";
    midA.frequency.value = 1000;
    midA.Q.value = 1;
    midA.gain.value = 0;

    const highA = audioCtx.createBiquadFilter();
    highA.type = "highshelf";
    highA.frequency.value = 4000;
    highA.gain.value = 0;

    // BíŠ¸ë™ EQ
    const lowB = audioCtx.createBiquadFilter();
    lowB.type = "lowshelf";
    lowB.frequency.value = 200;

    const midB = audioCtx.createBiquadFilter();
    midB.type = "peaking";
    midB.frequency.value = 1000;
    midB.Q.value = 1;

    const highB = audioCtx.createBiquadFilter();
    highB.type = "highshelf";
    highB.frequency.value = 4000;

    // ë¼ìš°íŒ…
    sourceA.connect(lowA);
    lowA.connect(midA);
    midA.connect(highA);
    highA.connect(gainA);
    gainA.connect(audioCtx.destination);

    sourceB.connect(lowB);
    lowB.connect(midB);
    midB.connect(highB);
    highB.connect(gainB);
    gainB.connect(audioCtx.destination);

    // --------- UI ìš”ì†Œ ----------
    const deckA = document.getElementById("deckA");
    const deckB = document.getElementById("deckB");

    const playA = document.getElementById("playA");
    const playB = document.getElementById("playB");

    const volA = document.getElementById("volA");
    const volB = document.getElementById("volB");
    const volAVal = document.getElementById("volAVal");
    const volBVal = document.getElementById("volBVal");

    const bpmB = document.getElementById("bpmB");
    const bpmBVal = document.getElementById("bpmBVal");

    const eqHigh = document.getElementById("eqHigh");
    const eqMid = document.getElementById("eqMid");
    const eqLow = document.getElementById("eqLow");
    const eqHighVal = document.getElementById("eqHighVal");
    const eqMidVal = document.getElementById("eqMidVal");
    const eqLowVal = document.getElementById("eqLowVal");
    const eqRowHigh = document.getElementById("eqRowHigh");
    const eqRowMid = document.getElementById("eqRowMid");
    const eqRowLow = document.getElementById("eqRowLow");

    const toast = document.getElementById("toast");

    // Waveforms
    const waveA = document.getElementById("waveA");
    const waveAProg = document.getElementById("waveAProg");
    const waveAFlag = document.getElementById("waveAFlag");
    const waveB = document.getElementById("waveB");
    const waveBProg = document.getElementById("waveBProg");

    let durationA = 240;
    let durationB = 240;

    audioA.addEventListener("loadedmetadata", () => {
      if (!isNaN(audioA.duration) && audioA.duration > 0) {
        durationA = audioA.duration;
      }
    });
    audioB.addEventListener("loadedmetadata", () => {
      if (!isNaN(audioB.duration) && audioB.duration > 0) {
        durationB = audioB.duration;
      }
    });

    function updateWaveforms() {
      if (durationA > 0) {
        const p = (audioA.currentTime / durationA) * 100;
        waveAProg.style.width = Math.min(Math.max(p, 0), 100) + "%";

        const flagPos = (A_FLAG / durationA) * 100;
        waveAFlag.style.left = Math.min(Math.max(flagPos, 0), 100) + "%";
      }
      if (durationB > 0) {
        const pB = (audioB.currentTime / durationB) * 100;
        waveBProg.style.width = Math.min(Math.max(pB, 0), 100) + "%";
      }
      requestAnimationFrame(updateWaveforms);
    }
    requestAnimationFrame(updateWaveforms);

    // íŠœí† ë¦¬ì–¼ ì˜¤ë²„ë ˆì´
    const overlay = document.getElementById("overlay");
    const overlayEyebrow = document.getElementById("overlayEyebrow");
    const overlayTitle = document.getElementById("overlayTitle");
    const overlayBody = document.getElementById("overlayBody");
    const overlayStepText = document.getElementById("overlayStepText");
    const overlayNext = document.getElementById("overlayNext");
    const overlaySkip = document.getElementById("overlaySkip");

    const startTutorialTop = document.getElementById("startTutorialTop");

    // Lang elements
    const logoTitle = document.getElementById("logoTitle");
    const logoSub = document.getElementById("logoSub");
    const headerTagline = document.getElementById("headerTagline");
    const langLabel = document.getElementById("langLabel");
    const langKoBtn = document.getElementById("langKo");
    const langEnBtn = document.getElementById("langEn");

    const heroTitle = document.getElementById("heroTitle");
    const heroSub = document.getElementById("heroSub");
    const heroButtonText = document.getElementById("heroButtonText");
    const heroHint = document.getElementById("heroHint");

    const djHeaderLeft = document.getElementById("djHeaderLeft");
    const djHeaderRight = document.getElementById("djHeaderRight");

    const deckALabel = document.getElementById("deckALabel");
    const deckAPill = document.getElementById("deckAPill");
    const deckBLabel = document.getElementById("deckBLabel");
    const deckBPill = document.getElementById("deckBPill");
    const trackATitle = document.getElementById("trackATitle");
    const trackBTitle = document.getElementById("trackBTitle");
    const metaA = document.getElementById("metaA");
    const metaB = document.getElementById("metaB");
    const playALabel = document.getElementById("playALabel");
    const playBLabel = document.getElementById("playBLabel");
    const volALabel = document.getElementById("volALabel");
    const volBLabel = document.getElementById("volBLabel");
    const bpmLabel = document.getElementById("bpmLabel");
    const waveALabel = document.getElementById("waveALabel");
    const waveBLabel = document.getElementById("waveBLabel");

    const eqTitle = document.getElementById("eqTitle");
    const eqSubTitle = document.getElementById("eqSubTitle");
    const eqHighLabel = document.getElementById("eqHighLabel");
    const eqMidLabel = document.getElementById("eqMidLabel");
    const eqLowLabel = document.getElementById("eqLowLabel");
    const volSummaryTitle = document.getElementById("volSummaryTitle");
    const volSummaryA = document.getElementById("volSummaryA");
    const volSummaryB = document.getElementById("volSummaryB");

    // --------- ìƒíƒœ ---------
    let tutorialStep = 1;
    let isPlayingA = false;
    let isPlayingB = false;
    let currentLang = "ko";

    let awaitingBpm = false;
    let awaitingSyncPlay = false;
    let awaitingBVolumeRaise = false;
    let eqPhase = null; // 'high' -> 'mid' -> 'low' -> 'done'
    let awaitingVolumeFade = false;
    let awaitingStopA = false;

    // 0.5ì´ˆ ìœ ì§€ìš© íƒ€ì´ë¨¸ë“¤
    let bpmStableTimer = null;
    let volBStableTimer = null;
    let eqHighStableTimer = null;
    let eqMidStableTimer = null;
    let eqLowStableTimer = null;
    let volAStableTimer = null;

    function ensureAudioContext() {
      if (audioCtx.state === "suspended") {
        audioCtx.resume();
      }
    }

    function resetAudioState() {
      audioA.pause();
      audioB.pause();
      isPlayingA = false;
      isPlayingB = false;
      audioA.currentTime = A_START;
      audioB.currentTime = B_START;
      audioB.playbackRate = 127 / 127; // ê¸°ë³¸ 1
      playA.classList.remove("playing");
      playA.textContent = "â–¶";
      playB.classList.remove("playing");
      playB.textContent = "â–¶";
    }

    function resetControlState() {
      volA.value = 100;
      volB.value = 0;
      bpmB.value = 127;
      eqHigh.value = -20;
      eqMid.value = -20;
      eqLow.value = -20;

      awaitingBpm = false;
      awaitingSyncPlay = false;
      awaitingBVolumeRaise = false;
      eqPhase = null;
      awaitingVolumeFade = false;
      awaitingStopA = false;

      bpmStableTimer = volBStableTimer = eqHighStableTimer =
        eqMidStableTimer = eqLowStableTimer = volAStableTimer = null;

      deckA.classList.remove("highlight");
      deckB.classList.remove("highlight");
      waveA.classList.remove("wave-highlight");
      waveB.classList.remove("wave-highlight");
      eqRowHigh.classList.remove("eq-highlight");
      eqRowMid.classList.remove("eq-highlight");
      eqRowLow.classList.remove("eq-highlight");
      playA.classList.remove("highlight-control");
      playB.classList.remove("highlight-control");
      volB.classList.remove("highlight-control");

      updateVolumesFromSliders();
      updateBpmDisplay();
      updateEqDisplays();
      applyEq();
    }

    function startBaseTrack() {
      ensureAudioContext();
      audioA.currentTime = A_START;
      audioA.play();
      isPlayingA = true;
      playA.classList.add("playing");
      playA.textContent = "â¸";
    }

    function updateVolumesFromSliders() {
      const a = Number(volA.value) / 100;
      const b = Number(volB.value) / 100;
      gainA.gain.value = a;
      gainB.gain.value = b;
      volAVal.textContent = Math.round(a * 100) + "%";
      volBVal.textContent = Math.round(b * 100) + "%";

      const statusVolAEl = document.getElementById("statusVolA");
      const statusVolBEl = document.getElementById("statusVolB");
      if (statusVolAEl) statusVolAEl.textContent = volAVal.textContent;
      if (statusVolBEl) statusVolBEl.textContent = volBVal.textContent;
    }

    function updateBpmDisplay() {
      bpmBVal.textContent = bpmB.value;
    }

    function updateEqDisplays() {
      eqHighVal.textContent = eqHigh.value + " dB";
      eqMidVal.textContent = eqMid.value + " dB";
      eqLowVal.textContent = eqLow.value + " dB";
    }

    function applyEq() {
      const vHigh = Number(eqHigh.value);
      const vMid  = Number(eqMid.value);
      const vLow  = Number(eqLow.value);

      // BíŠ¸ë™: ê·¸ëŒ€ë¡œ ì ìš©
      highB.gain.value = vHigh;
      midB.gain.value  = vMid;
      lowB.gain.value  = vLow;

      // AíŠ¸ë™: Bê°€ +ë¡œ ì˜¬ë¼ê°ˆìˆ˜ë¡ í•´ë‹¹ ëŒ€ì—­ì„ ë°˜ëŒ€ë¡œ ì¡°ê¸ˆ ê¹ìŒ
      const factor = 0.7;
      highA.gain.value = vHigh > 0 ? -vHigh * factor : 0;
      midA.gain.value  = vMid  > 0 ? -vMid  * factor : 0;
      lowA.gain.value  = vLow  > 0 ? -vLow  * factor : 0;
    }

    // --------- Toast ---------
    function showToast(message) {
      toast.textContent = message;
      toast.classList.add("visible");
      clearTimeout(showToast._timeout);
      showToast._timeout = setTimeout(() => {
        toast.classList.remove("visible");
      }, 2500);
    }

    // --------- ì–¸ì–´ ì ìš© ---------
    function applyLanguageTexts() {
      const S = STRINGS[currentLang];

      document.documentElement.lang = currentLang === "ko" ? "ko" : "en";

      logoTitle.textContent = S.logoTitle;
      logoSub.textContent = S.logoSub;
      headerTagline.textContent = S.headerTagline;
      langLabel.textContent = S.langLabel;

      heroTitle.textContent = S.heroTitle;
      heroSub.innerText = S.heroSub;
      heroButtonText.textContent = S.heroButtonText;
      heroHint.textContent = S.heroHint;

      djHeaderLeft.innerHTML = S.djHeaderLeft;
      djHeaderRight.textContent = S.djHeaderRight;

      deckALabel.textContent = S.deckALabel;
      deckAPill.textContent = S.deckAPill;
      deckBLabel.textContent = S.deckBLabel;
      deckBPill.textContent = S.deckBPill;
      trackATitle.textContent = S.trackATitle;
      trackBTitle.textContent = S.trackBTitle;
      metaA.textContent = S.metaA;
      metaB.textContent = S.metaB;
      playALabel.textContent = S.playLabel;
      playBLabel.textContent = S.playLabel;
      volALabel.textContent = S.volLabel;
      volBLabel.textContent = S.volLabel;
      bpmLabel.textContent = S.bpmLabel;
      waveALabel.textContent = S.waveALabel;
      waveBLabel.textContent = S.waveBLabel;

      eqTitle.textContent = S.eqTitle;
      eqSubTitle.textContent = S.eqSubTitle;
      eqHighLabel.textContent = S.eqHighLabel;
      eqMidLabel.textContent = S.eqMidLabel;
      eqLowLabel.textContent = S.eqLowLabel;
      volSummaryTitle.textContent = S.volSummaryTitle;
      volSummaryA.innerHTML = S.volSummaryA;
      volSummaryB.innerHTML = S.volSummaryB;

      overlaySkip.textContent = S.overlaySkip;
      overlayNext.textContent = S.overlayNext;

      renderTutorialStepText(tutorialStep);
      // ìƒˆë¡œ ìƒê¸´ ìƒíƒœ í…ìŠ¤íŠ¸ strongì— í˜„ì¬ ê°’ ë°˜ì˜
      updateVolumesFromSliders();
    }

    function setLanguage(lang) {
      currentLang = lang === "en" ? "en" : "ko";
      langKoBtn.classList.toggle("active", currentLang === "ko");
      langEnBtn.classList.toggle("active", currentLang === "en");
      applyLanguageTexts();
    }

    // --------- íŠœí† ë¦¬ì–¼ ìŠ¤í… ì •ì˜ ë Œë” ---------
    function renderTutorialStepText(step) {
      const S = STRINGS[currentLang];
      const info = S.tutorial[step];
      if (!info) return;
      overlayEyebrow.textContent = info.eyebrow;
      overlayTitle.innerHTML = info.title;
      overlayBody.innerHTML = info.body;
      overlayStepText.textContent = info.stepsText;
    }

    function showTutorialStep(step) {
      tutorialStep = step;
      renderTutorialStepText(step);

      deckA.classList.remove("highlight");
      deckB.classList.remove("highlight");
      waveA.classList.remove("wave-highlight");
      waveB.classList.remove("wave-highlight");
      eqRowHigh.classList.remove("eq-highlight");
      eqRowMid.classList.remove("eq-highlight");
      eqRowLow.classList.remove("eq-highlight");
      playA.classList.remove("highlight-control");
      playB.classList.remove("highlight-control");
      volB.classList.remove("highlight-control");

      if (step === 3) {
        deckA.classList.add("highlight");
      } else if (step === 4) {
        deckB.classList.add("highlight");
      } else if (step === 5) {
        waveA.classList.add("wave-highlight");
        waveB.classList.add("wave-highlight");
      } else if (step === 6) {
        deckB.classList.add("highlight");
      } else if (step === 7) {
        eqRowHigh.classList.add("eq-highlight");
      } else if (step === 8) {
        deckA.classList.add("highlight");
      }

      overlay.classList.remove("hidden");
    }

    function hideTutorial() {
      overlay.classList.add("hidden");
    }

    // --------- 0.5ì´ˆ ìœ ì§€ ì²´í¬ í—¬í¼ ---------
    function makeStableChecker(timerRefName, conditionFn, onStable) {
      return function() {
        if (conditionFn()) {
          if (!window[timerRefName]) {
            window[timerRefName] = setTimeout(() => {
              if (conditionFn()) {
                onStable();
              }
              clearTimeout(window[timerRefName]);
              window[timerRefName] = null;
            }, 500); // 0.5ì´ˆ
          }
        } else {
          if (window[timerRefName]) {
            clearTimeout(window[timerRefName]);
            window[timerRefName] = null;
          }
        }
      };
    }

    // --------- í”Œë ˆì´ ë²„íŠ¼ ---------
    playA.addEventListener("click", () => {
      ensureAudioContext();
      if (!isPlayingA) {
        audioA.play();
        isPlayingA = true;
        playA.classList.add("playing");
        playA.textContent = "â¸";
      } else {
        audioA.pause();
        isPlayingA = false;
        playA.classList.remove("playing");
        playA.textContent = "â–¶";

        if (awaitingStopA) {
          awaitingStopA = false;
          showTutorialStep(9);
        }
      }
    });

    playB.addEventListener("click", async () => {
      ensureAudioContext();
      if (!isPlayingB) {
        if (awaitingSyncPlay) {
          // ì´ íƒ€ì´ë°ì—ë§Œ ë¯¹ìŠ¤ í¬ì¸íŠ¸ë¡œ ì í”„
          audioA.currentTime = A_FLAG;   // 59.6ì´ˆ
          audioB.currentTime = B_START;  // 15.2ì´ˆ

          if (!isPlayingA) {
            audioA.play();
            isPlayingA = true;
            playA.classList.add("playing");
            playA.textContent = "â¸";
          }
        }

        audioB.play();
        isPlayingB = true;
        playB.classList.add("playing");
        playB.textContent = "â¸";

        if (awaitingSyncPlay) {
          awaitingSyncPlay = false;
          const T = STRINGS[currentLang].toasts;
          showToast(T.syncDone);
          await sleep(1000);
          showTutorialStep(6);
        }
      } else {
        audioB.pause();
        isPlayingB = false;
        playB.classList.remove("playing");
        playB.textContent = "â–¶";
      }
    });


    // --------- ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸ ---------

    // A ë³¼ë¥¨: 0ê¹Œì§€ ë‚´ë ¤ê°„ ìƒíƒœ ìœ ì§€
    const checkVolAStable = makeStableChecker(
      "volAStableTimer",
      () => awaitingVolumeFade && Number(volA.value) === 0,
      () => {
        awaitingVolumeFade = false;
        const T = STRINGS[currentLang].toasts;
        playA.classList.add("highlight-control");
        awaitingStopA = true;
        showToast(T.volAStop);
      }
    );

    volA.addEventListener("input", () => {
      updateVolumesFromSliders();
      checkVolAStable();
    });

    // B ë³¼ë¥¨: 100ê¹Œì§€ ì˜¬ë¦° ìƒíƒœ ìœ ì§€
    const checkVolBStable = makeStableChecker(
      "volBStableTimer",
      () => awaitingBVolumeRaise && Number(volB.value) === 100,
      async () => {
        awaitingBVolumeRaise = false;
        volB.classList.remove("highlight-control");
        const T = STRINGS[currentLang].toasts;
        showToast(T.volBDone);
        await sleep(1000)
        showTutorialStep(7);
      }
    );

    volB.addEventListener("input", () => {
      updateVolumesFromSliders();
      checkVolBStable();
    });

    const checkBpmStable = makeStableChecker(
      "bpmStableTimer",
      () => awaitingBpm && Number(bpmB.value) === 131,
      async () => {
        awaitingBpm = false;
        const T = STRINGS[currentLang].toasts;
        showToast(T.bpmPerfect);
        await sleep(1000);
        showTutorialStep(5);
      }
    );

    bpmB.addEventListener("input", (e) => {
      const bpmValue = Number(e.target.value);
      bpmBVal.textContent = bpmValue;
      // ì‹¤ì œ ì˜¤ë””ì˜¤ ì¬ìƒ ì†ë„ëŠ” ì´ë¯¸ 131 BPMìœ¼ë¡œ ë Œë”ë§ë˜ì–´ ìˆì–´ì„œ
      // ìŠ¬ë¼ì´ë”ëŠ” 'ì—°ìŠµìš©' UIì¼ ë¿ì…ë‹ˆë‹¤ :)
      checkBpmStable();
    });

    // EQ thresholds: ìµœëŒ“ê°’(10)ê¹Œì§€ ì˜¬ë¦° ìƒíƒœ
    function eqFullyUp(val) {
      return Number(val) >= 10;
    }

    const checkHighStable = makeStableChecker(
      "eqHighStableTimer",
      () => eqPhase === "high" && eqFullyUp(eqHigh.value),
      () => {
        eqRowHigh.classList.remove("eq-highlight");
        eqRowMid.classList.add("eq-highlight");
        eqPhase = "mid";
        const T = STRINGS[currentLang].toasts;
        showToast(T.eqHigh);
      }
    );

    const checkMidStable = makeStableChecker(
      "eqMidStableTimer",
      () => eqPhase === "mid" && eqFullyUp(eqMid.value),
      () => {
        eqRowMid.classList.remove("eq-highlight");
        eqRowLow.classList.add("eq-highlight");
        eqPhase = "low";
        const T = STRINGS[currentLang].toasts;
        showToast(T.eqMid);
      }
    );

    const checkLowStable = makeStableChecker(
      "eqLowStableTimer",
      () => eqPhase === "low" && eqFullyUp(eqLow.value),
      async () => {
        eqRowLow.classList.remove("eq-highlight");
        eqPhase = "done";
        const T = STRINGS[currentLang].toasts;
        showToast(T.eqLow);
        await sleep(1000);
        showTutorialStep(8);
      }
    );

    eqHigh.addEventListener("input", () => {
      updateEqDisplays();
      applyEq();
      checkHighStable();
    });

    eqMid.addEventListener("input", () => {
      updateEqDisplays();
      applyEq();
      checkMidStable();
    });

    eqLow.addEventListener("input", () => {
      updateEqDisplays();
      applyEq();
      checkLowStable();
    });

    // --------- íŠœí† ë¦¬ì–¼ ë²„íŠ¼ ---------
    overlayNext.addEventListener("click", () => {
      ensureAudioContext();
      const T = STRINGS[currentLang].toasts;

      if (tutorialStep === 1) {
        resetAudioState();
        resetControlState();
        startBaseTrack();
        showTutorialStep(2);
      } else if (tutorialStep === 2) {
        showTutorialStep(3);
      } else if (tutorialStep === 3) {
        showTutorialStep(4);
      } else if (tutorialStep === 4) {
          hideTutorial();
        awaitingBpm = true;
        deckB.classList.add("highlight");
        // BPM ë§ì¶”ëŠ” ë‹¨ê³„ ì‹œì‘
        showToast(T.bpmAsk);
      } else if (tutorialStep === 5) {
        // íƒ€ì´ë° ë§ì¶° B ì‹œì‘
        hideTutorial();
        awaitingSyncPlay = true;
        waveA.classList.add("wave-highlight");
        waveB.classList.add("wave-highlight");
        playB.classList.add("highlight-control");
        showToast(T.syncHint);
      } else if (tutorialStep === 6) {
        // B ë³¼ë¥¨ ì˜¬ë¦¬ê¸° ì‹œì‘
        hideTutorial();
        awaitingBVolumeRaise = true;
        volB.classList.add("highlight-control");
        showToast(T.volBAsk);
      } else if (tutorialStep === 7) {
        // EQ ë‹¨ê³„
        hideTutorial();
        eqPhase = "high";
        eqRowHigh.classList.add("eq-highlight");
      } else if (tutorialStep === 8) {
        // A ë³¼ë¥¨ í˜ì´ë“œ ë‹¨ê³„
        hideTutorial();
        awaitingVolumeFade = true;
        deckA.classList.add("highlight");
        showToast(T.volAFade);
      } else if (tutorialStep === 9) {
        hideTutorial();
      }
    });

    overlaySkip.addEventListener("click", () => {
      hideTutorial();
      const T = STRINGS[currentLang].toasts;
      showToast(T.skipOverlay);
    });

    startTutorialTop.addEventListener("click", () => {
      const T = STRINGS[currentLang].toasts;
      showToast(T.skipTop);

      resetAudioState();
      resetControlState();
      showTutorialStep(1);
    });

    // --------- ì–¸ì–´ ìŠ¤ìœ„ì¹˜ ì´ë²¤íŠ¸ ---------
    langKoBtn.addEventListener("click", () => setLanguage("ko"));
    langEnBtn.addEventListener("click", () => setLanguage("en"));

    // --------- ì´ˆê¸° ì„¸íŒ… ---------
    function init() {
      updateVolumesFromSliders();
      updateBpmDisplay();
      updateEqDisplays();
      applyEq();
      setLanguage("ko");
      showTutorialStep(1);
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    window.addEventListener("load", init);
  </script>
</body>
</html>



